$(document).ready(function() {

  var mymap = L.map('map').setView([37.9449, 23.8698], 10);
  L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoicmVwdXRnbG9yeTEiLCJhIjoiY2p5YTdpdDF3MGIzeTNpb2duOWE2OHh1diJ9.D6EFltnyZ4QXGqu-pbXpsA', {
      attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
      maxZoom: 14,
      id: 'mapbox.streets',
      accessToken: 'your.mapbox.access.token'
  }).addTo(mymap);


  var popup = L.popup();

  var polygons = [];


  var latlngs0 = [[38.16295367, 24.03630723],
  [38.16197858, 24.03590425],
  [38.16208599, 24.03599798],
  [38.16225004, 24.03606119],
  [38.16263069, 24.03647333],
  [38.16350636, 24.03742146],
  [38.16365663, 24.03758416],
  [38.16376784, 24.03793873],
  [38.16509270, 24.04216317],
  [38.16539146, 24.04292087],
  [38.16546203, 24.04309985],
  [38.16488656, 24.04424407],
  [38.16431141, 24.04450385],
  [38.16402359, 24.04528405],
  [38.16221531, 24.04778007],
  [38.16225450, 24.05220212],
  [38.16173048, 24.05204083],
  [38.16089921, 24.05178497],
  [38.15901069, 24.04965076],
  [38.15814830, 24.04923400],
  [38.15788109, 24.04925889],
  [38.15703923, 24.04933730],
  [38.15686937, 24.04920585],
  [38.15145478, 24.04501620],
  [38.15118776, 24.04503858],
  [38.15117713, 24.04511908],
  [38.15117038, 24.04517067],
  [38.15060338, 24.04949925],
  [38.15058922, 24.04960740],
  [38.15198657, 24.05345843],
  [38.15203878, 24.05360232],
  [38.15181483, 24.05505128],
  [38.14994498, 24.05480247],
  [38.14609844, 24.05525186],
  [38.14619716, 24.05733793],
  [38.14617170, 24.05731210],
  [38.14616432, 24.05730787],
  [38.14582030, 24.05711068],
  [38.14577408, 24.05709505],
  [38.14552916, 24.05701224],
  [38.14544184, 24.05698271],
  [38.14512715, 24.05678755],
  [38.14495530, 24.05668098],
  [38.14444161, 24.05662459],
  [38.14436575, 24.05663718],
  [38.14402153, 24.05669431],
  [38.14381067, 24.05672931],
  [38.14337803, 24.05680422],
  [38.14286432, 24.05679241],
  [38.14259397, 24.05672159],
  [38.14246793, 24.05643263],
  [38.14237180, 24.05625260],
  [38.14220877, 24.05594728],
  [38.14219780, 24.05592673],
  [38.14197251, 24.05585488],
  [38.14187351, 24.05556594],
  [38.14151309, 24.05539342],
  [38.14106245, 24.05541020],
  [38.14088412, 24.05542357],
  [38.14063884, 24.05544197],
  [38.14046759, 24.05547144],
  [38.14011909, 24.05548694],
  [38.14008905, 24.05548827],
  [38.14008113, 24.05549178],
  [38.13969241, 24.05566378],
  [38.13936793, 24.05572380],
  [38.13898928, 24.05595745],
  [38.13880892, 24.05619017],
  [38.13850224, 24.05671272],
  [38.13828574, 24.05711979],
  [38.13804218, 24.05755536],
  [38.13794482, 24.05771903],
  [38.13782570, 24.05791928],
  [38.13776909, 24.05807715],
  [38.13769033, 24.05829681],
  [38.13756403, 24.05854348],
  [38.13741977, 24.05864606],
  [38.13717645, 24.05860344],
  [38.13696017, 24.05856118],
  [38.13672590, 24.05844582],
  [38.13646462, 24.05825947],
  [38.13625747, 24.05798544],
  [38.13622819, 24.05783208],
  [38.13622151, 24.05779713],
  [38.13614874, 24.05775130],
  [38.13614004, 24.05774582],
  [38.13596924, 24.05763825],
  [38.13589995, 24.05768234],
  [38.13571680, 24.05779887],
  [38.13532931, 24.05769943],
  [38.13482463, 24.05764412],
  [38.13449116, 24.05764636],
  [38.13401344, 24.05773620],
  [38.13349961, 24.05796971],
  [38.13311188, 24.05834808],
  [38.13272411, 24.05878494],
  [38.13238140, 24.05925106],
  [38.13207479, 24.05961380],
  [38.13184039, 24.05974590],
  [38.13165622, 24.05981646],
  [38.13153390, 24.05986332],
  [38.13152404, 24.05987749],
  [38.13111901, 24.06045952],
  [38.13097467, 24.06073574],
  [38.13072222, 24.06092486],
  [38.13034356, 24.06117343],
  [38.12999192, 24.06145019],
  [38.12967644, 24.06150947],
  [38.12937001, 24.06151135],
  [38.12902753, 24.06151320],
  [38.12869413, 24.06138420],
  [38.12837884, 24.06109620],
  [38.12817170, 24.06079260],
  [38.12794657, 24.06043194],
  [38.12777550, 24.06009985],
  [38.12747821, 24.05985430],
  [38.12701870, 24.05959614],
  [38.12651426, 24.05925102],
  [38.12617171, 24.05919470],
  [38.12558599, 24.05899456],
  [38.12523458, 24.05882314],
  [38.12480212, 24.05852045],
  [38.12454987, 24.05831952],
  [38.12416245, 24.05807499],
  [38.12385609, 24.05793106],
  [38.12345058, 24.05780311],
  [38.12318921, 24.05780397],
  [38.12294587, 24.05780592],
  [38.12261241, 24.05777856],
  [38.12240512, 24.05777946],
  [38.12205368, 24.05767972],
  [38.12198097, 24.05760983],
  [38.12191855, 24.05754984],
  [38.12174744, 24.05727589],
  [38.12172620, 24.05705289],
  [38.12171120, 24.05702887],
  [38.12170767, 24.05699185],
  [38.12153118, 24.05687497],
  [38.12141775, 24.05679985],
  [38.12148108, 24.05640789],
  [38.12197914, 24.05332490],
  [38.12206908, 24.05131655],
  [38.12210657, 24.05047919],
  [38.12245611, 24.05037195],
  [38.12898977, 24.04836708],
  [38.13160824, 24.04520875],
  [38.13308737, 24.04284724],
  [38.13403324, 24.04070011],
  [38.13426570, 24.03988313],
  [38.13468027, 24.03842610],
  [38.13546465, 24.03566910],
  [38.13532010, 24.03275426],
  [38.13498136, 24.03079049],
  [38.13459394, 24.02956307],
  [38.13413756, 24.02813952],
  [38.13261866, 24.02340217],
  [38.13214907, 24.02193770],
  [38.13207537, 24.02170789],
  [38.13545836, 24.01922391],
  [38.13573965, 24.01901736],
  [38.13577422, 24.01909614],
  [38.13582412, 24.01921752],
  [38.13614834, 24.01895897],
  [38.13814195, 24.01559475],
  [38.14212597, 24.00866052],
  [38.14264000, 24.00776573],
  [38.14253774, 24.00854225],
  [38.14322978, 24.01123466],
  [38.14325298, 24.01132490],
  [38.15455066, 24.00717102],
  [38.15498093, 24.00701279],
  [38.15542910, 24.00684798],
  [38.15747236, 24.00151917],
  [38.15744121, 24.00140646],
  [38.15730059, 24.00089762],
  [38.15741129, 24.00074866],
  [38.15761057, 24.00048051],
  [38.15769321, 24.00036931],
  [38.15842933, 24.00297984],
  [38.16001361, 24.00537589],
  [38.16008313, 24.00545921],
  [38.16149766, 24.01042154],
  [38.16163561, 24.01316439],
  [38.16165066, 24.01346375],
  [38.16165356, 24.01364481],
  [38.16116795, 24.01367086],
  [38.16004587, 24.01375947],
  [38.15874353, 24.01391796],
  [38.15768453, 24.01406472],
  [38.15684183, 24.01418155],
  [38.15625150, 24.01426562],
  [38.15660698, 24.01802842],
  [38.15676000, 24.01925334],
  [38.15772438, 24.01908844],
  [38.15823339, 24.02025463],
  [38.15861629, 24.02107087],
  [38.15903969, 24.02206762],
  [38.15932348, 24.02263130],
  [38.15962980, 24.02321996],
  [38.16000814, 24.02415750],
  [38.16056661, 24.02564624],
  [38.16110702, 24.02714926],
  [38.16202639, 24.02680395],
  [38.16223801, 24.02755349],
  [38.16257567, 24.02884245],
  [38.16275125, 24.02952207],
  [38.16309796, 24.03059916],
  [38.16352586, 24.03134989],
  [38.16394928, 24.03198219],
  [38.16442229, 24.03253604],
  [38.16509356, 24.03316383],
  [38.16554406, 24.03359283],
  [38.16602153, 24.03430545],
  [38.16631880, 24.03478612],
  [38.16685498, 24.03502289],
  [38.16701269, 24.03506756],
  [38.16782380, 24.03514358],
  [38.16827427, 24.03565288],
  [38.16870665, 24.03639370],
  [38.16922462, 24.03721734],
  [38.16940170, 24.03753350],
  [38.16924364, 24.03761484],
  [38.16803717, 24.03823575],
  [38.16507853, 24.03879982],
  [38.16494063, 24.03856142],
  [38.16385118, 24.03667815],
  [38.16295367, 24.03630723]];
  polygons.push(L.polygon(latlngs0, {color: 'green'}).addTo(mymap));


  var latlngs1 = [[38.22310343, 23.77463562],
  [38.22016750, 23.77575209],
  [38.21654696, 23.77705870],
  [38.21570690, 23.78083881],
  [38.21536561, 23.78636799],
  [38.21312507, 23.78834285],
  [38.21019918, 23.79011146],
  [38.20768391, 23.78967786],
  [38.20538452, 23.78900809],
  [38.20310386, 23.78873842],
  [38.20034433, 23.78779953],
  [38.19738824, 23.78780597],
  [38.19372868, 23.78754929],
  [38.19075280, 23.78658942],
  [38.18846302, 23.78626174],
  [38.18489165, 23.78992610],
  [38.18246579, 23.79418097],
  [38.18006881, 23.79960009],
  [38.17670272, 23.80231841],
  [38.17355176, 23.80437622],
  [38.17045931, 23.80916148],
  [38.16941251, 23.81394078],
  [38.16861002, 23.81947993],
  [38.16387305, 23.82186919],
  [38.16047764, 23.82342201],
  [38.15642555, 23.82581875],
  [38.15305879, 23.82850788],
  [38.14988823, 23.82979713],
  [38.14758813, 23.82850249],
  [38.14567987, 23.82404364],
  [38.14447657, 23.82098199],
  [38.14327288, 23.81772323],
  [38.14387929, 23.81361193],
  [38.14494637, 23.81022654],
  [38.14463247, 23.80566103],
  [38.14156922, 23.80089654],
  [38.14289982, 23.79898035],
  [38.14722575, 23.79890321],
  [38.14783154, 23.79482149],
  [38.14615708, 23.79078117],
  [38.14426764, 23.78754336],
  [38.14443270, 23.78415774],
  [38.14548859, 23.78006080],
  [38.14629906, 23.77494913],
  [38.14506909, 23.77273928],
  [38.14474351, 23.77215612],
  [38.14433239, 23.77162174],
  [38.14405230, 23.77125850],
  [38.14275402, 23.76872303],
  [38.14126460, 23.76302937],
  [38.13804905, 23.76176635],
  [38.13707867, 23.75881297],
  [38.14141926, 23.75930294],
  [38.14459910, 23.75852109],
  [38.14590916, 23.75572358],
  [38.14580932, 23.75109511],
  [38.14503327, 23.74643083],
  [38.14432738, 23.74508913],
  [38.14251763, 23.74591245],
  [38.14160420, 23.74653792],
  [38.14004282, 23.74760994],
  [38.13899532, 23.74875967],
  [38.13825801, 23.74956955],
  [38.13530340, 23.75028889],
  [38.13480264, 23.74791682],
  [38.13154169, 23.74449677],
  [38.13057101, 23.74160058],
  [38.13072543, 23.73807326],
  [38.13085914, 23.73341033],
  [38.13010264, 23.72971162],
  [38.12754713, 23.72757711],
  [38.12411153, 23.72680479],
  [38.12135022, 23.72533054],
  [38.12106491, 23.72281138],
  [38.12192339, 23.71997201],
  [38.12098330, 23.71880872],
  [38.11779232, 23.71859850],
  [38.11390646, 23.71801095],
  [38.11181028, 23.71583419],
  [38.11177973, 23.71438667],
  [38.10880413, 23.71379941],
  [38.10827288, 23.71032355],
  [38.10484714, 23.70995070],
  [38.10386539, 23.70657345],
  [38.10334337, 23.70326678],
  [38.10302700, 23.69935768],
  [38.10432511, 23.69596479],
  [38.10655357, 23.69339377],
  [38.10860895, 23.69358373],
  [38.11118633, 23.69696655],
  [38.11155309, 23.69243821],
  [38.11034584, 23.68918197],
  [38.10955757, 23.68423692],
  [38.11128533, 23.67992083],
  [38.11122302, 23.67691179],
  [38.11388063, 23.67324721],
  [38.11655822, 23.67031950],
  [38.11671066, 23.66684833],
  [38.11705644, 23.66169609],
  [38.11629761, 23.65797102],
  [38.11468094, 23.65680251],
  [38.11414825, 23.65341235],
  [38.11191000, 23.65541703],
  [38.11006801, 23.65425506],
  [38.10861419, 23.65026925],
  [38.11103512, 23.64610128],
  [38.11529818, 23.64314859],
  [38.11862851, 23.63877768],
  [38.12124321, 23.63329404],
  [38.12781579, 23.63117428],
  [38.12868467, 23.63090784],
  [38.13302007, 23.62958166],
  [38.13778050, 23.62871888],
  [38.13915413, 23.62846942],
  [38.14235138, 23.62919284],
  [38.14282015, 23.62922756],
  [38.14600037, 23.63026818],
  [38.14695214, 23.63057009],
  [38.15155450, 23.63246431],
  [38.15570783, 23.63488498],
  [38.15716322, 23.63921332],
  [38.15906748, 23.64301636],
  [38.16346648, 23.64628283],
  [38.16784422, 23.64849811],
  [38.17378427, 23.64875821],
  [38.17994051, 23.64898235],
  [38.18656619, 23.64947582],
  [38.19160912, 23.65113033],
  [38.19712105, 23.65291167],
  [38.20069771, 23.64943878],
  [38.20427460, 23.64607976],
  [38.20593345, 23.64926626],
  [38.20559919, 23.65507973],
  [38.20411884, 23.66047409],
  [38.20310943, 23.66676444],
  [38.20430685, 23.66951157],
  [38.20890919, 23.67163743],
  [38.21376705, 23.67492114],
  [38.21745895, 23.67701950],
  [38.22073168, 23.68075464],
  [38.22287004, 23.68498019],
  [38.22476328, 23.68858831],
  [38.22529564, 23.69224091],
  [38.22522424, 23.69946882],
  [38.22422312, 23.70630095],
  [38.22343642, 23.71252727],
  [38.22172800, 23.71787269],
  [38.22114488, 23.72278412],
  [38.22258670, 23.72654977],
  [38.22585799, 23.73034345],
  [38.22797436, 23.73360468],
  [38.22878125, 23.73975215],
  [38.22892229, 23.74654690],
  [38.22926830, 23.75242445],
  [38.22894818, 23.75883626],
  [38.22884355, 23.76501238],
  [38.22828838, 23.77140233],
  [38.22673344, 23.77358367],
  [38.22310343, 23.77463562]];
  polygons.push(L.polygon(latlngs1, {color: 'green'}).addTo(mymap));


  var latlngs2 = [[37.76083577, 24.02294197],
  [37.76074090, 24.02412017],
  [37.76080603, 24.02512671],
  [37.76066610, 24.02616121],
  [37.76011383, 24.02710828],
  [37.75912671, 24.02782385],
  [37.75848441, 24.02831035],
  [37.75781953, 24.02891179],
  [37.75733729, 24.02908260],
  [37.75630751, 24.02913647],
  [37.75600784, 24.02904944],
  [37.75518550, 24.02858651],
  [37.75456822, 24.02803818],
  [37.75383597, 24.02774843],
  [37.75374358, 24.02774804],
  [37.75323863, 24.02860882],
  [37.75270644, 24.03027414],
  [37.75160674, 24.03058657],
  [37.75057478, 24.03035309],
  [37.74988988, 24.02997715],
  [37.74922523, 24.02965869],
  [37.74860789, 24.02936899],
  [37.74801070, 24.02962593],
  [37.74759589, 24.03042920],
  [37.74773320, 24.03097588],
  [37.74766294, 24.03249121],
  [37.74764264, 24.03254690],
  [37.74761784, 24.03261996],
  [37.74680825, 24.03487524],
  [37.74332804, 24.03839222],
  [37.73727730, 24.04632377],
  [37.73357131, 24.05009390],
  [37.73132555, 24.05340829],
  [37.73116330, 24.05344080],
  [37.73105507, 24.05359854],
  [37.73114066, 24.05367946],
  [37.73127130, 24.05380190],
  [37.73159576, 24.05383157],
  [37.73180301, 24.05394734],
  [37.73164974, 24.05404723],
  [37.73147849, 24.05404604],
  [37.73128922, 24.05401754],
  [37.73097378, 24.05397298],
  [37.73095125, 24.05395877],
  [37.73083862, 24.05388670],
  [37.73057731, 24.05372622],
  [37.73024382, 24.05372491],
  [37.72999144, 24.05373856],
  [37.72974807, 24.05375292],
  [37.72932444, 24.05377993],
  [37.72900902, 24.05367756],
  [37.72876576, 24.05346071],
  [37.72849549, 24.05317220],
  [37.72837837, 24.05305651],
  [37.72815303, 24.05306982],
  [37.72790961, 24.05319909],
  [37.72767522, 24.05331346],
  [37.72743184, 24.05335514],
  [37.72722454, 24.05335499],
  [37.72702631, 24.05322435],
  [37.72686414, 24.05305082],
  [37.72667492, 24.05292125],
  [37.72640452, 24.05293453],
  [37.72617909, 24.05314998],
  [37.72588157, 24.05333594],
  [37.72555700, 24.05352188],
  [37.72522344, 24.05369292],
  [37.72495295, 24.05387889],
  [37.72469146, 24.05410920],
  [37.72464863, 24.05414073],
  [37.72226680, 24.05431807],
  [37.72049611, 24.05338775],
  [37.71807622, 24.05299527],
  [37.71411230, 24.04850266],
  [37.70929922, 24.04845414],
  [37.70405288, 24.04988011],
  [37.70040215, 24.05069230],
  [37.69515576, 24.05214630],
  [37.69035147, 24.05255693],
  [37.68553834, 24.05259430],
  [37.68023935, 24.05063427],
  [37.67606503, 24.04795730],
  [37.67190181, 24.04556659],
  [37.66842371, 24.04272973],
  [37.66798222, 24.04226777],
  [37.66793718, 24.04220574],
  [37.66787637, 24.04212917],
  [37.66784257, 24.04212666],
  [37.66775926, 24.04193846],
  [37.66752495, 24.04185117],
  [37.66725449, 24.04200869],
  [37.66702010, 24.04210813],
  [37.66674974, 24.04200699],
  [37.66650646, 24.04176201],
  [37.66646155, 24.04133005],
  [37.66616442, 24.04043768],
  [37.66593908, 24.04045102],
  [37.66568671, 24.04044982],
  [37.66555155, 24.04033530],
  [37.66530828, 24.04007545],
  [37.66514607, 24.03995950],
  [37.66508310, 24.03961364],
  [37.66508322, 24.03924089],
  [37.66503833, 24.03869308],
  [37.66490330, 24.03818951],
  [37.66469614, 24.03771425],
  [37.66447994, 24.03735380],
  [37.66426366, 24.03720948],
  [37.66402930, 24.03726606],
  [37.66384895, 24.03752462],
  [37.66359654, 24.03763894],
  [37.66334411, 24.03778160],
  [37.66310973, 24.03791081],
  [37.66276723, 24.03786634],
  [37.66248783, 24.03783680],
  [37.66220841, 24.03786393],
  [37.66206434, 24.03738873],
  [37.66203747, 24.03684237],
  [37.66195649, 24.03639660],
  [37.66177631, 24.03609393],
  [37.66142483, 24.03599172],
  [37.66113641, 24.03594836],
  [37.66096527, 24.03557413],
  [37.66093832, 24.03525772],
  [37.66088432, 24.03498346],
  [37.66053290, 24.03466584],
  [37.66033462, 24.03460799],
  [37.65990200, 24.03452028],
  [37.65984799, 24.03429032],
  [37.65997429, 24.03391623],
  [37.66007349, 24.03373027],
  [37.65991130, 24.03354312],
  [37.65973107, 24.03339778],
  [37.65953283, 24.03322550],
  [37.65933456, 24.03312337],
  [37.65913618, 24.03342479],
  [37.65883869, 24.03359720],
  [37.65850518, 24.03366720],
  [37.65813555, 24.03393913],
  [37.65764873, 24.03429710],
  [37.65746845, 24.03432536],
  [37.65732419, 24.03448295],
  [37.65719792, 24.03475605],
  [37.65716180, 24.03499978],
  [37.65716174, 24.03518684],
  [37.65699943, 24.03541706],
  [37.65673810, 24.03522881],
  [37.65653092, 24.03481136],
  [37.65639584, 24.03439395],
  [37.65626975, 24.03406299],
  [37.65615263, 24.03386099],
  [37.65610758, 24.03378870],
  [37.65593631, 24.03384531],
  [37.65571097, 24.03385973],
  [37.65549468, 24.03377248],
  [37.65529636, 24.03384360],
  [37.65520615, 24.03413053],
  [37.65529619, 24.03444800],
  [37.65524202, 24.03473494],
  [37.65495358, 24.03477661],
  [37.65467417, 24.03477648],
  [37.65426857, 24.03476035],
  [37.65406126, 24.03476025],
  [37.65393508, 24.03473079],
  [37.65393513, 24.03457208],
  [37.65404335, 24.03438613],
  [37.65414257, 24.03412791],
  [37.65415165, 24.03389764],
  [37.65411568, 24.03359366],
  [37.65410669, 24.03352350],
  [37.65418787, 24.03329326],
  [37.65421947, 24.03310728],
  [37.65427816, 24.03274701],
  [37.65430527, 24.03248840],
  [37.65453065, 24.03231739],
  [37.65478307, 24.03217366],
  [37.65491829, 24.03207381],
  [37.65474711, 24.03181405],
  [37.65456688, 24.03167014],
  [37.65438665, 24.03152623],
  [37.65414332, 24.03139575],
  [37.65392704, 24.03126529],
  [37.65360262, 24.03104834],
  [37.65345844, 24.03090444],
  [37.65315208, 24.03051533],
  [37.65299888, 24.03041465],
  [37.65274649, 24.03048469],
  [37.65253914, 24.03067166],
  [37.65230478, 24.03067050],
  [37.65216062, 24.03046851],
  [37.65193530, 24.03042556],
  [37.65180016, 24.03018035],
  [37.65183634, 24.02967731],
  [37.65167417, 24.02938923],
  [37.65162010, 24.02935980],
  [37.65167426, 24.02904347],
  [37.65158421, 24.02869874],
  [37.65134084, 24.02872592],
  [37.65103432, 24.02901240],
  [37.65074582, 24.02929924],
  [37.65035815, 24.02967212],
  [37.65002460, 24.02988631],
  [37.64980821, 24.03014447],
  [37.64958277, 24.03054681],
  [37.64942947, 24.03083369],
  [37.64915901, 24.03107731],
  [37.64886155, 24.03111898],
  [37.64855511, 24.03108945],
  [37.64844022, 24.03094735],
  [37.64840196, 24.03077127],
  [37.64656094, 24.03089910],
  [37.64612874, 24.02918300],
  [37.64491955, 24.02545178],
  [37.64455474, 24.02435283],
  [37.64449406, 24.02356607],
  [37.64464518, 24.02280311],
  [37.64527854, 24.02194287],
  [37.64595462, 24.02150098],
  [37.64669155, 24.02107434],
  [37.64763815, 24.01995697],
  [37.64802591, 24.01877744],
  [37.64834837, 24.01730881],
  [37.64864601, 24.01588303],
  [37.64872280, 24.01456383],
  [37.64759645, 24.01159080],
  [37.64698586, 24.01087903],
  [37.64643613, 24.00989382],
  [37.64584360, 24.00860539],
  [37.64541554, 24.00744806],
  [37.64552829, 24.00599961],
  [37.64581451, 24.00506410],
  [37.64643647, 24.00411726],
  [37.64849836, 23.99911363],
  [37.64826398, 23.99709974],
  [37.64817156, 23.99607491],
  [37.64811969, 23.99485560],
  [37.64825936, 23.99406349],
  [37.64848236, 23.99272371],
  [37.64866928, 23.99116748],
  [37.64869850, 23.99016495],
  [37.64875920, 23.98863672],
  [37.64887848, 23.98715913],
  [37.64890534, 23.98557988],
  [37.64900431, 23.98424611],
  [37.64915505, 23.98258145],
  [37.64935989, 23.98113322],
  [37.64944987, 23.98022525],
  [37.64964792, 23.97881315],
  [37.64964770, 23.97764482],
  [37.64968573, 23.97618812],
  [37.64959532, 23.97489655],
  [37.64939228, 23.97380587],
  [37.64895937, 23.97259838],
  [37.64838001, 23.97154117],
  [37.64765875, 23.97078549],
  [37.64676620, 23.96991370],
  [37.64609007, 23.96939644],
  [37.64533954, 23.96877082],
  [37.64479181, 23.96816071],
  [37.64368733, 23.96692671],
  [37.64306737, 23.96591957],
  [37.64255111, 23.96506508],
  [37.64196259, 23.96378415],
  [37.64158143, 23.96268521],
  [37.64136482, 23.96178243],
  [37.64117070, 23.96075673],
  [37.64096522, 23.95949336],
  [37.64087020, 23.95841803],
  [37.64083142, 23.95709118],
  [37.64084230, 23.95604554],
  [37.64060305, 23.95499084],
  [37.64040203, 23.95377780],
  [37.64028666, 23.95265219],
  [37.64026580, 23.95120987],
  [37.64031253, 23.94981815],
  [37.64067487, 23.94876095],
  [37.64108451, 23.94768917],
  [37.64130481, 23.94650807],
  [37.64159274, 23.94542857],
  [37.64193463, 23.94409682],
  [37.64215025, 23.94264153],
  [37.64233442, 23.94140269],
  [37.64272140, 23.94022248],
  [37.64621403, 23.93580448],
  [37.64742389, 23.93545947],
  [37.64829347, 23.93507613],
  [37.64937931, 23.93458631],
  [37.65070174, 23.93406900],
  [37.65176069, 23.93385268],
  [37.65286934, 23.93386019],
  [37.65348687, 23.93405201],
  [37.65457328, 23.93459345],
  [37.65539383, 23.93518332],
  [37.65616247, 23.93565031],
  [37.65681387, 23.93598667],
  [37.65769049, 23.93611523],
  [37.65897939, 23.93608826],
  [37.65972091, 23.93640367],
  [37.66023040, 23.93683264],
  [37.66113263, 23.93851980],
  [37.66144180, 23.93940922],
  [37.66174185, 23.94011086],
  [37.66199007, 23.94081220],
  [37.66236448, 23.94152195],
  [37.66258789, 23.94219426],
  [37.66302542, 23.94296917],
  [37.66352819, 23.94354987],
  [37.66403767, 23.94400797],
  [37.66462370, 23.94435831],
  [37.66535159, 23.94449347],
  [37.66632943, 23.94425499],
  [37.66717871, 23.94377033],
  [37.66769216, 23.94312469],
  [37.66827531, 23.94216540],
  [37.66937111, 23.94356209],
  [37.66930356, 23.94364754],
  [37.66908744, 23.94406725],
  [37.66896139, 23.94436925],
  [37.66885338, 23.94468221],
  [37.66877241, 23.94500437],
  [37.66870045, 23.94533325],
  [37.66865554, 23.94566779],
  [37.66862866, 23.94600656],
  [37.66861980, 23.94634674],
  [37.66863798, 23.94668583],
  [37.66867418, 23.94702278],
  [37.66872841, 23.94735583],
  [37.66874651, 23.94750003],
  [37.66877360, 23.94762935],
  [37.66885478, 23.94775969],
  [37.66891793, 23.94788863],
  [37.66907118, 23.94794663],
  [37.66923343, 23.94794652],
  [37.66941368, 23.94791805],
  [37.66963903, 23.94796183],
  [37.66981035, 23.94810593],
  [37.66985551, 23.94832240],
  [37.66984660, 23.94855274],
  [37.66984674, 23.94886882],
  [37.66994599, 23.94912742],
  [37.66997318, 23.94945837],
  [37.66989226, 23.94994742],
  [37.66972109, 23.95011975],
  [37.66954991, 23.95030590],
  [37.66932471, 23.95062248],
  [37.66909951, 23.95095253],
  [37.66900044, 23.95113862],
  [37.66890140, 23.95139807],
  [37.66888346, 23.95159899],
  [37.66882048, 23.95187223],
  [37.66869440, 23.95213099],
  [37.66856830, 23.95235997],
  [37.66853232, 23.95254709],
  [37.66832519, 23.95299050],
  [37.66819912, 23.95328787],
  [37.66807305, 23.95358950],
  [37.66795600, 23.95389572],
  [37.66783895, 23.95420407],
  [37.66773091, 23.95451701],
  [37.66763188, 23.95483243],
  [37.66754187, 23.95515210],
  [37.66745186, 23.95547319],
  [37.66737086, 23.95579745],
  [37.66729888, 23.95612419],
  [37.66722689, 23.95645306],
  [37.66716392, 23.95678405],
  [37.66710996, 23.95711751],
  [37.66708298, 23.95727520],
  [37.66707406, 23.95754840],
  [37.66706513, 23.95776384],
  [37.66703821, 23.95812457],
  [37.66712848, 23.95848382],
  [37.66716476, 23.95914499],
  [37.66704773, 23.95957593],
  [37.66688564, 23.96000689],
  [37.66662450, 23.96075538],
  [37.66645336, 23.96107047],
  [37.66621919, 23.96161732],
  [37.66595800, 23.96224888],
  [37.66570580, 23.96279432],
  [37.66552571, 23.96336948],
  [37.66537715, 23.96386668],
  [37.66534563, 23.96397263],
  [37.66533677, 23.96444780],
  [37.66540903, 23.96499413],
  [37.66550830, 23.96538208],
  [37.66567067, 23.96584334],
  [37.66586006, 23.96620396],
  [37.66604042, 23.96656317],
  [37.66620276, 23.96690892],
  [37.66637412, 23.96726814],
  [37.66655449, 23.96765712],
  [37.66665374, 23.96803125],
  [37.66670795, 23.96852092],
  [37.66672612, 23.96905277],
  [37.66675333, 23.96970012],
  [37.66673541, 23.97011648],
  [37.66669049, 23.97069228],
  [37.66656444, 23.97126636],
  [37.66643837, 23.97172881],
  [37.66647667, 23.97172490],
  [37.66670716, 23.97455487],
  [37.66716504, 23.97759707],
  [37.66741111, 23.97923224],
  [37.66856553, 23.98370621],
  [37.66918110, 23.98789891],
  [37.66926914, 23.98849859],
  [37.67089193, 23.99366127],
  [37.67250548, 23.99821965],
  [37.67289757, 24.00049819],
  [37.67393861, 24.00177747],
  [37.67624600, 24.00300793],
  [37.67969809, 24.00380617],
  [37.68361210, 24.00476612],
  [37.68662246, 24.00661041],
  [37.68984016, 24.00761661],
  [37.69374292, 24.00783039],
  [37.69808738, 24.00734308],
  [37.70496451, 24.00779399],
  [37.71003886, 24.00967111],
  [37.71397743, 24.01226805],
  [37.71627576, 24.01286837],
  [37.72133213, 24.01362630],
  [37.72556608, 24.01394729],
  [37.72926379, 24.01380471],
  [37.73503243, 24.01246198],
  [37.73963835, 24.01098728],
  [37.74491081, 24.01377711],
  [37.74994897, 24.01570636],
  [37.75263473, 24.01709362],
  [37.75285094, 24.01776946],
  [37.75312573, 24.01851769],
  [37.75369572, 24.01915247],
  [37.75426793, 24.01993023],
  [37.75465537, 24.02070795],
  [37.75486031, 24.02131216],
  [37.75508544, 24.02240522],
  [37.75549529, 24.02367148],
  [37.75602017, 24.02436307],
  [37.75705226, 24.02399303],
  [37.75751207, 24.02330458],
  [37.75799675, 24.02215634],
  [37.75847911, 24.02135293],
  [37.75909890, 24.02060738],
  [37.75965104, 24.02014915],
  [37.76024583, 24.02063998],
  [37.76054091, 24.02124461],
  [37.76083577, 24.02294197]];
  polygons.push(L.polygon(latlngs2, {color: 'green'}).addTo(mymap));

  var latlngs3 = [[37.93121699, 23.99885741],
  [37.93029767, 24.00062047],
  [37.93031569, 24.00178647],
  [37.93036967, 24.00498185],
  [37.93021616, 24.00970912],
  [37.93054002, 24.01534537],
  [37.93131429, 24.02088258],
  [37.93231366, 24.02618493],
  [37.93203295, 24.03155978],
  [37.93090153, 24.03261365],
  [37.92965740, 24.03383669],
  [37.92873337, 24.03453571],
  [37.92822396, 24.03511792],
  [37.92752979, 24.03570039],
  [37.92688516, 24.03634118],
  [37.92633068, 24.03692334],
  [37.92582125, 24.03756419],
  [37.92554621, 24.03803020],
  [37.92513126, 24.03907857],
  [37.92471636, 24.04001065],
  [37.92420680, 24.04094267],
  [37.92379198, 24.04158317],
  [37.92314271, 24.04251508],
  [37.92277745, 24.04315594],
  [37.92217337, 24.04373799],
  [37.92185315, 24.04443718],
  [37.92106866, 24.04536896],
  [37.92009952, 24.04600906],
  [37.91968032, 24.04624203],
  [37.91931079, 24.04624180],
  [37.91866632, 24.04635766],
  [37.91843647, 24.04641582],
  [37.91820659, 24.04653229],
  [37.91783701, 24.04664868],
  [37.91755761, 24.04664850],
  [37.91718807, 24.04664827],
  [37.91658871, 24.04664789],
  [37.91617416, 24.04653101],
  [37.91589929, 24.04647253],
  [37.91580467, 24.04643302],
  [37.91503405, 24.04643537],
  [37.91433560, 24.04631726],
  [37.91372727, 24.04619884],
  [37.91321355, 24.04613986],
  [37.91274940, 24.04608056],
  [37.91251509, 24.04602140],
  [37.91172204, 24.04578521],
  [37.91130293, 24.04578495],
  [37.91101902, 24.04578477],
  [37.91059992, 24.04578451],
  [37.91032052, 24.04578434],
  [37.91004111, 24.04578416],
  [37.90966708, 24.04578393],
  [37.90929301, 24.04584271],
  [37.90863946, 24.04613701],
  [37.90789133, 24.04625421],
  [37.90742714, 24.04631292],
  [37.90709812, 24.04643038],
  [37.90658431, 24.04660709],
  [37.90546656, 24.04695973],
  [37.90513751, 24.04713619],
  [37.90481302, 24.04719499],
  [37.90439382, 24.04743040],
  [37.90380796, 24.04746238],
  [37.90307791, 24.04746191],
  [37.90254618, 24.04737768],
  [37.90198291, 24.04727246],
  [37.90123494, 24.04697837],
  [37.90058615, 24.04662144],
  [37.90001844, 24.04634810],
  [37.89953639, 24.04597031],
  [37.89904086, 24.04548766],
  [37.89855875, 24.04527729],
  [37.89820952, 24.04521417],
  [37.89797971, 24.04516853],
  [37.89732896, 24.04399306],
  [37.89955648, 24.04033612],
  [37.90180168, 24.03742864],
  [37.90335286, 24.03433651],
  [37.90539020, 24.03293049],
  [37.90968141, 24.02904825],
  [37.91144894, 24.02474094],
  [37.91113441, 24.01985445],
  [37.90880051, 24.01692101],
  [37.90714255, 24.01353856],
  [37.90545758, 24.00866041],
  [37.90424106, 24.00440209],
  [37.90625104, 24.00123987],
  [37.90647637, 24.00001026],
  [37.90600766, 23.99750556],
  [37.90461950, 23.99336330],
  [37.90529500, 23.98751177],
  [37.90298699, 23.98219299],
  [37.90067885, 23.97745145],
  [37.89974953, 23.97281740],
  [37.89835088, 23.96648715],
  [37.89718607, 23.95969458],
  [37.89808553, 23.95461983],
  [37.90219406, 23.95114126],
  [37.90769144, 23.94981557],
  [37.91342348, 23.94929547],
  [37.91984117, 23.95035593],
  [37.92420503, 23.95425213],
  [37.92856846, 23.95731316],
  [37.93224654, 23.95957090],
  [37.93661015, 23.96366995],
  [37.93845925, 23.96870376],
  [37.93893860, 23.97573485],
  [37.93827281, 23.98228015],
  [37.93622763, 23.98837141],
  [37.93418204, 23.99276215],
  [37.93121699, 23.99885741]];
  polygons.push(L.polygon(latlngs3, {color: 'green'}).addTo(mymap));


  var objects = [];

  for(let i=0;i<4;i++) {
    objects.push({time: 14, temperature: 32, humidity: 21, wind_speed: 4, fire_class: "X"});
  }


  var last_clicked = 0;

  //objects[1].temperature = 3;

  for(let i=0;i<4;i++) {
    console.log(i + ": " + objects[i].temperature);
  }

  var weather_api_names = ["IATTIKIN1",
                          "IACHARNE2",
                          "ILAURIUM2",
                          "IACHARNE2"];

  var api_names = ['neamakri',
                  'parnitha',
                  'lavrio',
                  'spata'];


  polygons[0].on('click', function () {
    var coordinates = polygons[0].getBounds().getCenter();
    popMe(coordinates, "Εθνικό Πάρκο Σχινιά Μαραθώνα");
    last_clicked = 0;
    show_fields();
  });

  polygons[1].on('click', function () {
    var coordinates = polygons[1].getBounds().getCenter();
    popMe(coordinates, "Όρος Πάρνηθα");
    last_clicked = 1;
    show_fields();
  });

  polygons[2].on('click', function () {
    var coordinates = polygons[2].getBounds().getCenter();
    popMe(coordinates, "Σούνιο");
    last_clicked = 2;
    show_fields();
  });

  polygons[3].on('click', function () {
    var coordinates = polygons[3].getBounds().getCenter();
    popMe(coordinates, "Βραυρώνα");
    last_clicked = 3;
    show_fields();
  });


  function show_fields() {
    $("#my_table").html("");

    $("#temperature").val(objects[last_clicked].temperature);
    $("#humidity").val(objects[last_clicked].humidity);
    $("#wind_speed").val(objects[last_clicked].wind_speed);
    $("#time").val(objects[last_clicked].time);
    $("#direction").val(objects[last_clicked].direction);
  }


  function popMe(coordinates, name) {
    popup
    .setLatLng(coordinates)
    .setContent(name)
    .openOn(mymap);
  }


  $("#calculate").click( function() {
    objects[last_clicked].temperature = $("#temperature").val();
    objects[last_clicked].humidity = $("#humidity").val();
    objects[last_clicked].wind_speed = $("#wind_speed").val();
    objects[last_clicked].time = $("#time").val();
    objects[last_clicked].direction = $("#direction").val();

    //console.log(JSON.stringify(objects[last_clicked]));
    

    // call api for weather and the send to flask server

    var date = new Date($('#date-input').val());
    day = date.getDate();
    if(day<10)
      day = "0" + day;
    month = date.getMonth() + 1;
    if(month<10)
      month = "0" + month;
    year = date.getFullYear();
  

    $.ajax(
      {
        url: "https://api.weather.com/v2/pws/history/hourly?format=json&units=m&apiKey=063bea321f8d4b04bbea321f8d6b042d&stationId=" + weather_api_names[last_clicked] + "&date=" + year + month + day,
        type: "GET",
        success: function(result1){

          $("#my_table").html("<tr><th>Time</th><th>Class</th><th>Temp</th><th>Wind</th></tr>");

          //console.log(result1);
          

          for(let i=8;i<18;i++) {
            console.log(result1["observations"][i]);


            //"average_temp", "avg_wind", "max_temp", "max_wind"

            var average_temp = result1["observations"][i]["metric"].tempAvg;
            var avg_wind = result1["observations"][i]["metric"].windspeedAvg;
            var max_temp = result1["observations"][i]["metric"].tempHigh;
            var max_wind = result1["observations"][i]["metric"].windspeedHigh;
            
            var madata = {average_temp: average_temp, avg_wind: avg_wind, max_temp: max_temp, max_wind: max_wind};
            console.log(JSON.stringify(madata));

            $.ajax(
              {
                url: "http://127.0.0.1:5000/" + api_names[last_clicked],
                type: "POST",
                data: JSON.stringify(madata),
                dataType: "json",
                contentType: "application/json",
                success: function(result){
                    var km = parseFloat(result);
                    var fire_class = "X";
                              
                    if(km >= 5000)
                      fire_class = "G";
                    else if(km >= 1000)
                      fire_class = "F";
                    else if(km >= 300)
                      fire_class = "E";
                    else if(km >= 100)
                      fire_class = "D";
                    else if(km >= 10)
                      fire_class = "C";
                    else if(km >= 0.25)
                      fire_class = "B";
                    else
                      fire_class = "A";
                    

                    var html = '<tr><td>' + result1["observations"][i].obsTimeLocal.substring(11, result1["observations"][i].obsTimeLocal.length) + ': </td><td style="width: 100%">' + fire_class + "</td><td>" + result1["observations"][i]["metric"].tempAvg + '</td><td>' + result1["observations"][i]["metric"].windspeedAvg + '</td></tr>';
                    $( "#my_table" ).append( html );
      
                    console.log(fire_class);
                    
                    if(i==14) {
                      objects[last_clicked].fire_class = fire_class;
                      polygons[last_clicked].setStyle({
                        color: colormap.get(fire_class)
                      });
                    }
                  }
            });
  
          }
          
      }
    });

  });

  let colormap = new Map();

  colormap.set('A', '#0000FF');   // a string key
  colormap.set('B', '#2B00D5');   // a string key
  colormap.set('C', '#5500AA');   // a string key
  colormap.set('D', '#800080');   // a string key
  colormap.set('E', '#AA0055');   // a string key
  colormap.set('F', '#D5002B');   // a string key
  colormap.set('G', '#FF0000');   // a string key

});
